# 数字图像处理第六次作业

姓名：王霄汉
班级：自动化钱61
学号：2160405061

提交日期：2019.4.2

---

##摘要
&emsp;&emsp;针对第六次作业的三个问题，本文采用MATLAB处理。对于问题一和二，利用**imnoise()**函数的‘gaussian’‘salt&pepper’参数产生高斯噪声和椒盐噪声，利用**fspecial()、medfilt2()、imfilter()**的函数执行均值滤波、中值滤波、逆谐波均值滤波等操作；
&emsp;&emsp;对于问题三，首先编写运动模糊函数，然后给模糊图像增加高斯噪声，最后利用matlab的**deconvwnr()、deconvreg()**函数进行维纳滤波和最小二乘滤波；

---
##一、技术讨论和报告
###1.1问题一
在测试图像上产生高斯噪声lena图-需能指定均值和方差；并用多种滤波器恢复图像，分析各自优缺点；
解：
（1）利用**imnoise()**函数的gaussian参数生成高斯噪声，可通过M,N参数调整均值和方差
（2）利用**fspecial()**函数的average参数生成均值滤波模板，直接用**imfilter()**函数可执行算数均值滤波；
对噪声图像取对数，再执行均值滤波，最后求指数可得到几何均值滤波结果；
取噪声图像的Q+1次幂进行均值滤波，再除以取Q次幂的均值滤波结果可以进行逆谐波均值滤波；
利用**medfilt2()**函数可以进行制定模板大小的中值滤波；

###1.2问题二
在测试图像lena图加入椒盐噪声（椒和盐噪声密度均是0.1）；用学过的滤波器恢复图像；在使用反谐波分析Q大于0和小于0的作用；
解：
（1）利用**imnoise()**函数的salt&pepper参数生成椒盐噪声，可通过M参数调整噪声密度；
（2）同上利用**fspecial()**函数进行均值滤波，通过选择Q的正负值来进行正值和负值的逆谐波均值滤波，利用**medfilt2()**函数进行中值滤波；

###1.3问题三
推导维纳滤波器并实现下边要求；
(a) 实现模糊滤波器如方程Eq. (5.6-11).
(b) 模糊lena图像：45度方向，T=1；
(c) 再模糊的lena图像中增加高斯噪声，均值= 0 ，方差=10 pixels 以产生模糊图像；
(d)分别利用方程 Eq. (5.8-6)和(5.9-4)，恢复图像；并分析算法的优缺点.
解：
（1）维纳滤波器的实现如下，
![info1](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/info1.png)
![info2](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/info2.png)
![info3](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/info3.png)
（2）按照公式编写模糊滤波器的函数，首先进行fft变换，然后获取尺寸，生成两层循环，按照公式处理每个像素，最后进行ifft反变换，取实部即为生成的运动模糊结果（具体见附件代码）
（3）按照问题一的方法再在源图像上添加高斯噪声，取均值为0，方差为0.01；
（4）利用matlab函数**deconvwnr()函数**进行维纳滤波，参数采用**fspecial()**函数的‘motion’生成的模板；利用**deconvreg()**函数进行最小二乘滤波；


##二、结果讨论
###2.1问题一
![gaussian_restore](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/I1.bmp)`图1.1 高斯噪声恢复`

算数均值滤波虽然模糊了源图像，但是中和了噪声；几何均值滤波丢失的细节更小，但是产生了黑斑点的噪声；逆谐波对于高斯噪声的恢复能力较弱；中值滤波的效果与算数均值滤波的效果相近；

###2.2问题二
![salt&pepper_restore](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/I2.bmp)`图2.1 椒盐噪声恢复`

可以看到，算数均值滤波和中值滤波都对椒盐噪声有很好地恢复效果，其中中值滤波效果最好；
调整正值逆谐波均值的参数Q为0.1时，不仅能滤除黑色的椒噪声，对于盐噪声的平滑效果也较好；
取Q=-1.5时，能完全去除盐噪声但是对于反而增加了椒噪声；

###2.3问题三
![wnr_zxec](https://picture-1258800683.cos.ap-chengdu.myqcloud.com/dip_6thhw/I3.bmp)`图3.1 运动模糊——维纳滤波和最小二乘`

可以看到维纳滤波和最小二乘滤波对于正常的模糊退化都有较好的恢复效果，但是对于噪声则效果较差，特别是最小二乘法对于噪声无效；
##三、附录
参考文献
[1]（美）冈萨雷斯等(Gonzalez,R.C.).数字图像处理（MATLAB版）[M].北京：电子工业出版社，2005：78-102.

**源代码见附件**
